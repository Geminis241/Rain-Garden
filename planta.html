<!-- ... (todo tu código original intacto hasta el final del formulario) ... -->

      <button type="submit" class="btn btn-success">Guardar Planta</button>
      <button type="button" class="btn btn-warning ms-2" onclick="modificarPlanta()">Modificar Planta</button>
      <button type="button" class="btn btn-danger ms-2" onclick="borrarPlanta()">Borrar Planta</button>
    </form>

    <div id="mensaje" class="mt-3"></div>
  </div>

  <script>
    const urlAppScript = "https://script.google.com/macros/s/AKfycbzLSy8Ho_SDzCEO0KFBDXFQA6W9xoabC-w8XP9HRYZmWTB6A8Kef0qDfyt_UZIv-RUh/exec";

    document.getElementById("formPlanta").addEventListener("submit", function (e) {
      e.preventDefault();
      enviarDatos("anadir");
    });

    function modificarPlanta() {
      enviarDatos("modificar");
    }

    function borrarPlanta() {
      const num = document.getElementById("num").value.trim();
      if (!num) {
        mostrarMensaje("Por favor, ingresa el número de cultivo para borrar.", "danger");
        return;
      }

      if (!confirm("¿Estás seguro de que deseas borrar esta planta?")) return;

      fetch(`${urlAppScript}?accion=borrar&num=${encodeURIComponent(num)}`, {
        method: "POST",
      })
        .then(res => res.json())
        .then(data => {
          if (data.status === "ok") {
            mostrarMensaje("Planta borrada correctamente.", "success");
            document.getElementById("formPlanta").reset();
          } else {
            mostrarMensaje("Error: " + (data.error || "Desconocido"), "danger");
          }
        })
        .catch(error => {
          mostrarMensaje("Error: " + error.message, "danger");
        });
    }

    function enviarDatos(accion) {
      const num = document.getElementById("num").value.trim();
      const nombre = document.getElementById("nombre").value.trim();
      const variedad = document.getElementById("variedad").value.trim();
      const nombreCientifico = document.getElementById("nombreCientifico").value.trim();
      const clasificacion = document.getElementById("clasificacion").value.trim();
      const metodoSiembra = document.getElementById("metodoSiembra").value.trim();
      const epocaSiembra = document.getElementById("epocaSiembra").value.trim();
      const mesesSiembra = document.getElementById("mesesSiembra").value.trim();
      const diasGerminacion = document.getElementById("diasGerminacion").value.trim();
      const diasCosecha = document.getElementById("diasCosecha").value.trim();
      const distancia = document.getElementById("distancia").value.trim();
      const tutor = document.getElementById("tutor").value.trim();
      const imagen = document.getElementById("imagen").value.trim();

      if (!num || !nombre) {
        mostrarMensaje("Número y nombre del cultivo son obligatorios.", "danger");
        return;
      }

      const valores = [
        num,
        nombre,
        variedad,
        nombreCientifico,
        clasificacion,
        metodoSiembra,
        epocaSiembra,
        mesesSiembra,
        diasGerminacion,
        diasCosecha,
        distancia,
        tutor,
        imagen,
      ].join(",");

      fetch(`${urlAppScript}?accion=${accion}&valores=${encodeURIComponent(valores)}`, {
        method: "POST",
      })
        .then((response) => response.json())
        .then((data) => {
          if (data.status === "ok") {
            mostrarMensaje(
              accion === "modificar"
                ? "Planta modificada correctamente."
                : "Planta añadida correctamente.",
              "success"
            );
            document.getElementById("formPlanta").reset();
          } else {
            mostrarMensaje("Error: " + (data.error || "Desconocido"), "danger");
          }
        })
        .catch((error) => {
          mostrarMensaje("Error: " + error.message, "danger");
        });
    }

    function mostrarMensaje(texto, tipo) {
      document.getElementById("mensaje").innerHTML = `<div class="alert alert-${tipo}">${texto}</div>`;
    }
  </script>
</body>
</html>
